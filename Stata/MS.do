set more offcapture log closeclearssc install fsumlog using "logs/size_$S_DATE", replaceuse "data//tenantmetadata_10.18.dta"rename oms OmsTenantIdjoinby Oms using "data//tenant_size.dta", unmatched(both)replace TenantS="1. SMB: 1-250" if TenantS=="SMB: 1-250"replace TenantS="2. SMS&P (Medium/Large): 500-1000" if TenantS=="SMS&P (Medium/Large): 500-1000"replace TenantS="3. SMS&P (Medium/Small): 250-500" if TenantS=="SMS&P (Medium/Small): 250-500"replace TenantS="4. Corporate Enterprise (EPG): 1000-5000" if TenantS=="Corporate Enterprise (EPG): 1000-5000"replace TenantS="5. Major Large Enterprise: 5000+" if TenantS=="Major Large Enterprise: 5000+"keep if _m==3bysort TenantSize: sum employeecount, detailbysort TenantSize: sum employeecount if employeetype=="Employees Here", detailbysort TenantSize: sum employeecount if employeetype=="Employees Total", detailstoplog using "logs/Data_description2_$S_DATE", replace/*insheet using "data//cultureofwork_06.13.csv"foreach var in msgsenders msgsentperuser msgsentlowerqtileval msgsentupperqtileval mtgattendees mtghoursperattendee mtghourslowerqtileval mtghoursupperqtileval {replace `var'="" if `var'=="#NUL#"destring `var', replace}save "data//cultureofwork_06.13.dta", replacedescribe, fullnamesfsum, labelclearinsheet using "data//networksize_06.20.csv"foreach var in internalnetworkupperquartilevalu externalnetworklowerquartilevalu externalnetworkupperquartilevalu {replace `var'="" if `var'=="#NUL#"destring `var', replace}				save "data//networksize_06.20.dta", replacedescribe, fullnamesfsum, labelclearinsheet using "data//utilization_06.13.csv"save "data//utilization_06.13.dta", replacedescribe, fullnamesfsum, labelclearinsheet using "data//utilization_08.09.csv"save "data//utilization_08.09.dta", replacedescribe, fullnamesfsum, labelstop/*foreach x in 04 05 06 07 08 09 {insheet using "data//cultureofwork_`x'-16.csv", names casesave "data//cultureofwork_`x'-16.dta", replaceclear}*/*/use "data//cultureofwork_04-16.dta"foreach x in 05 06 07 08 09 {append using "data//cultureofwork_`x'-16.dta"}rename TotalTwoAttendeeMeetingCount TotTwoAttendeeMtgCountrename TotalThreeAttendeeMeetingCount TotThreeAttendeeMtgCount rename TotalFourAttendeeMeetingCount TotFourAttendeeMtgCount rename TotalFiveAttendeeMeetingCount TotFiveAttendeeMtgCountrename TotalSixAttendeeMeetingCount TotSixAttendeeMtgCount rename TotalSevenAttendeeMeetingCount TotSevenAttendeeMtgCount rename TotalEightAttendeeMeetingCount TotEightAttendeeMtgCount rename TotalNineAttendeeMeetingCount TotNineAttendeeMtgCount rename TotalTenPlusAttendeeMeetingCount TotTenPlusAttendeeMtgCount label var msgSentPerUser_int "Avg # of Msgs Sent per User (Internal)"label var msgSentPerUser_ext "Avg # of Msgs Sent per User (External)"label var mtgsPerUser "Avg # of Meetings per User "label var mtgHoursPerAttendee "Average # of Mtg Hrs per Attendee"label var TotTwoAttendeeMtgCount "# of Mtgs where Attendee Count = 2"label var TotThreeAttendeeMtgCount  "# of Mtgs where Attendee Count = 3"label var TotFourAttendeeMtgCount "# of Mtgs where Attendee Count = 4"label var TotFiveAttendeeMtgCount "# of Mtgs where Attendee Count = 5"save "data//cultureofwork.dta", replacedescribe, fullnamefsum, labelstopforeach x in 03 04 05 06 07 08 09 10 {insheet using "data//messagenetworksize_`x'-16.csv", names casesave "data//messagenetworksize_`x'-16.dta", replaceclear}use "data//messagenetworksize_03-16.dta"compressforeach x in 04 05 06 07 08 09 10 {append using "data//messagenetworksize_`x'-16.dta"compress}save "data//messagenetworksize.dta", replaceclearuse "data//messagenetworksize.dta", foreach var in msgSentPerUser_int msgSentLowerQtileVal_int msgSentUpperQtileVal_int msgSenders_ext msgSentPerUser_ext msgSentLowerQtileVal_ext msgSentUpperQtileVal_ext mtgAttendees mtgHoursPerAttendee mtgHoursLowerQtileVal mtgHoursUpperQtileVal mtgsPerUser mtgsPerTenant TotalMeetingAttendanceCount TotalMeetingCount {replace `var'="" if `var'=="#NUL#"destring `var', replace}save "data//messagenetworksize.dta", replaceclear*/insheet using "data//tenantmetadata_10.18.csv"count if employeec=="NULL"replace employeec="" if employeec=="NULL"destring employeec, replacesum employeec, detailsave "data//tenantmetadata_10.18.dta", replacedlog using "logs//bigdataset_$S_DATE", replace/*use "data//cultureofwork.dta"describe, fullnamefsum, labeluse "data//messagenetworksize.dta"describe, fullnamefsum, labeluse "data//multicountrymeetingsweekly_09_02.dta"describe, fullnamefsum, labeluse "data//tenantmetadata_10.18"describe, fullnamefsum, label*/describe, fullnamefsum, label*/use "data//messagenetworksize.dta"         foreach var in msgSenders_int  internal_population  internal_mean_contacts    internal_stdev_contacts  external_population    external_mean_contacts   external_stdev_contacts     { replace `var'="" if `var'=="#NUL#"destring `var', replace}save "data//messagenetworksize.dta", replacedescribe, fullnamefsum, label/*log using "logs//multicountry_$S_DATE", replace*insheet using "data//multicountrymeetingsweekly_09_02.csv"*save multicountrymeetingsweekly_09_02.dta, replaceuse multicountrymeetingsweekly_09_02.dtadforeach var in weekstartdateid usercountry0 usercountry1 metricname  {tab `var'}bysort metricname: sum metricvalue, detail*g pair=usercountry0 + " + " + usercountry1*keep if oms=="80d1111-41b9-45b9-8ef4-454fc9f25a33" | oms=="9edfe74c-f37e-4153-827b-bd2c102f97f0" | oms=="005d8e5d-ae39-4954-95d6-04ceec280dd8"*save data//multicountry_jeff, replaceclearlog close*//*log using "logs//tenantdata_$S_DATE", replaceuse "data//tenantmetadata_10.18.dta"bysort oms country: egen max_rev=max(revenue)bysort oms country: egen max_emp=max(employeecount)keep if max_rev==revenueduplicates dropkeep sic* country lineofbusiness omsduplicates dropsave data//sic_huge, replaceg sic_small=substr(sic, 1, 2)countkeep country sic_ line omsduplicates dropsave data//sic_big, replacekeep country sic_ lineduplicates dropsave data//sic, replacestopforeach var in lineofbusiness isparent  {tab `var'}bysort sictype: tab sic*/